<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/DTD/strict.dtd">
<html debug="true">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>~ improved sourceBox prototype #2</title>
<script type="text/javascript" zsrc="../../../content/firebug-lite-dev.js"></script>
<script type="text/javascript" src="prettify.js"></script>
<script type="text/javascript">
// *************************************************************************************************

window.onload = function()
{
    var html = getResource("../../../build/syntax-test1.js");
    console.time("z");
    prettyPrintOne(html)
    console.timeEnd("z");
}

var getResource = function(url)
{
    var xhr = getXHRObject();
    xhr.open("get", url, false);
    xhr.send();
    
    return xhr.responseText;
};

var getXHRObject = function()
{
    var xhrObj = false;
    try
    {
        xhrObj = new XMLHttpRequest();
    }
    catch(e)
    {
        var progid = [
                "MSXML2.XMLHTTP.5.0", "MSXML2.XMLHTTP.4.0", 
                "MSXML2.XMLHTTP.3.0", "MSXML2.XMLHTTP", "Microsoft.XMLHTTP"
            ];
          
        for ( var i=0; i < progid.length; ++i ) {
            try
            {
                xhrObj = new ActiveXObject(progid[i]);
            }
            catch(e)
            {
                continue;
            }
            break;
        }
    }
    finally
    {
        return xhrObj;
    }
};


</script>
<style type="text/css">
html, body {
    margin: 0;
    padding: 0;
    overflow: hidden;
}


</style>
</head>
<body>

  <div id="out">Hi
  </div>
  
  <i>~ :O</i>

</body>
</html>